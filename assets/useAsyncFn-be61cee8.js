import{r as e}from"./index-8db94870.js";function w(a,o=[],R={loading:!1}){const n=e.useRef(0),t=e.useRef(R),i=m(),d=e.useRef(0),[,g]=e.useState(0),c=e.useCallback(()=>{d.current=Date.now(),i()&&g(Date.now())},[i]),l=e.useCallback(async r=>{const u=n.current;try{const s={value:await r,loading:!1,promise:r};return u===n.current&&(t.current=s),c(),s}catch(f){const s={error:f,loading:!1,promise:r};return u===n.current&&(t.current={error:f,loading:!1,promise:r}),c(),s}},[c]),C=e.useCallback(async(...r)=>{++n.current;const u=a(...r);return t.current={loading:!0,promise:u},c(),l(u)},[...o,c,l]);return e.useEffect(()=>{Date.now()>=d.current&&g(Date.now())},[]),n.current||(++n.current,t.current.loading&&t.current.promise&&l(t.current.promise)),[t.current,C]}function m(){const a=e.useRef(!1),o=e.useCallback(()=>a.current,[]);return e.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]),o}export{w as u};
//# sourceMappingURL=useAsyncFn-be61cee8.js.map
